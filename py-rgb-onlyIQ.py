###################################################
from HslCommunication import SiemensS7Net
from HslCommunication import SiemensPLCS
import time

siemens = SiemensS7Net(SiemensPLCS.S200Smart, "192.168.2.1")

if siemens.ConnectServer().IsSuccess == True:
    print ('')
    print ('连接成功 !')
    print ('')
    #print ('请按启动')
else:
    print ('')
    print ('连接失败 !')
    print ('')
    exit ()
###################################################

a=0

while 1:
    a=0
    #红色
    siemens.WriteBool("Q0.2",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.2",False)
    time.sleep(0.1)
    siemens.WriteBool("Q0.5",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.5",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.2",True)
    time.sleep(0.1)
    siemens.WriteBool("Q1.2",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.5",True)
    time.sleep(0.1)
    siemens.WriteBool("Q1.5",False)
    time.sleep(0.1)
    #绿色
    siemens.WriteBool("Q0.3",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.3",False)
    time.sleep(0.1)
    siemens.WriteBool("Q0.6",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.6",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.3",True)
    time.sleep(0.1)
    siemens.WriteBool("Q1.3",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.6",True)
    time.sleep(0.1)
    siemens.WriteBool("Q1.6",False)
    time.sleep(0.1)
    #蓝色
    siemens.WriteBool("Q0.4",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.4",False)
    time.sleep(0.1)
    siemens.WriteBool("Q0.7",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.7",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.4",True)
    time.sleep(0.1)
    siemens.WriteBool("Q1.4",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.7",True)
    time.sleep(0.1)
    siemens.WriteBool("Q1.7",False)
    time.sleep(0.1)
    #黄色
    siemens.WriteBool("Q0.2",True)
    siemens.WriteBool("Q0.3",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.2",False)
    siemens.WriteBool("Q0.3",False)
    time.sleep(0.1)
    siemens.WriteBool("Q0.5",True)
    siemens.WriteBool("Q0.6",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.5",False)
    siemens.WriteBool("Q0.6",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.2",True)
    siemens.WriteBool("Q1.3",True)
    time.sleep(0.1)
    siemens.WriteBool("Q1.2",False)
    siemens.WriteBool("Q1.3",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.5",True)
    siemens.WriteBool("Q1.6",True)
    time.sleep(0.1)
    siemens.WriteBool("Q1.5",False)
    siemens.WriteBool("Q1.6",False)
    time.sleep(0.1)
    #紫色
    siemens.WriteBool("Q0.2",True)
    siemens.WriteBool("Q0.4",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.2",False)
    siemens.WriteBool("Q0.4",False)
    time.sleep(0.1)
    siemens.WriteBool("Q0.5",True)
    siemens.WriteBool("Q0.7",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.5",False)
    siemens.WriteBool("Q0.7",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.2",True)
    siemens.WriteBool("Q1.4",True) 
    time.sleep(0.1)
    siemens.WriteBool("Q1.2",False)
    siemens.WriteBool("Q1.4",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.5",True)
    siemens.WriteBool("Q1.7",True)
    time.sleep(0.1)
    siemens.WriteBool("Q1.5",False)
    siemens.WriteBool("Q1.7",False)
    time.sleep(0.1)
    #青色
    siemens.WriteBool("Q0.3",True)
    siemens.WriteBool("Q0.4",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.3",False)
    siemens.WriteBool("Q0.4",False)
    time.sleep(0.1)
    siemens.WriteBool("Q0.6",True)
    siemens.WriteBool("Q0.7",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.6",False)
    siemens.WriteBool("Q0.7",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.3",True)
    siemens.WriteBool("Q1.4",True)
    time.sleep(0.1)
    siemens.WriteBool("Q1.3",False)
    siemens.WriteBool("Q1.4",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.6",True)
    siemens.WriteBool("Q1.7",True)
    time.sleep(0.1)
    siemens.WriteBool("Q1.6",False)
    siemens.WriteBool("Q1.7",False)
    time.sleep(0.1)
    #白色
    siemens.WriteBool("Q0.2",True)
    siemens.WriteBool("Q0.3",True)
    siemens.WriteBool("Q0.4",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.2",False)
    siemens.WriteBool("Q0.3",False)
    siemens.WriteBool("Q0.4",False)
    time.sleep(0.1)
    siemens.WriteBool("Q0.5",True)
    siemens.WriteBool("Q0.6",True)
    siemens.WriteBool("Q0.7",True)
    time.sleep(0.1)
    siemens.WriteBool("Q0.5",False)
    siemens.WriteBool("Q0.6",False)
    siemens.WriteBool("Q0.7",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.2",True)
    siemens.WriteBool("Q1.3",True)
    siemens.WriteBool("Q1.4",True)
    time.sleep(0.1)
    siemens.WriteBool("Q1.2",False)
    siemens.WriteBool("Q1.3",False)
    siemens.WriteBool("Q1.4",False)
    time.sleep(0.1)
    siemens.WriteBool("Q1.5",True)
    siemens.WriteBool("Q1.6",True)
    siemens.WriteBool("Q1.7",True)
    time.sleep(0.1)
    siemens.WriteBool("Q1.5",False)
    siemens.WriteBool("Q1.6",False)
    siemens.WriteBool("Q1.7",False)
    time.sleep(0.1)
    while a<2:
    #闪红
        siemens.WriteBool("Q0.2",True)
        siemens.WriteBool("Q0.5",True)
        siemens.WriteBool("Q1.2",True)
        siemens.WriteBool("Q1.5",True)
        time.sleep(0.1)
        siemens.WriteBool("Q0.2",False)
        siemens.WriteBool("Q0.5",False)
        siemens.WriteBool("Q1.2",False)
        siemens.WriteBool("Q1.5",False)
        time.sleep(0.1)
        #闪绿
        siemens.WriteBool("Q0.3",True)
        siemens.WriteBool("Q0.6",True)
        siemens.WriteBool("Q1.3",True)
        siemens.WriteBool("Q1.6",True)
        time.sleep(0.1)
        siemens.WriteBool("Q0.3",False)
        siemens.WriteBool("Q0.6",False)
        siemens.WriteBool("Q1.3",False)
        siemens.WriteBool("Q1.6",False)
        time.sleep(0.1)
        #闪蓝
        siemens.WriteBool("Q0.4",True)
        siemens.WriteBool("Q0.7",True)
        siemens.WriteBool("Q1.4",True)
        siemens.WriteBool("Q1.7",True)
        time.sleep(0.1)
        siemens.WriteBool("Q0.4",False)
        siemens.WriteBool("Q0.7",False)
        siemens.WriteBool("Q1.4",False)
        siemens.WriteBool("Q1.7",False)
        time.sleep(0.1)
        #闪黄
        siemens.WriteBool("Q0.2",True)
        siemens.WriteBool("Q0.3",True)
        siemens.WriteBool("Q0.5",True)
        siemens.WriteBool("Q0.6",True)
        siemens.WriteBool("Q1.2",True)
        siemens.WriteBool("Q1.3",True)
        siemens.WriteBool("Q1.5",True)
        siemens.WriteBool("Q1.6",True)
        time.sleep(0.1)
        siemens.WriteBool("Q0.2",False)
        siemens.WriteBool("Q0.3",False)
        siemens.WriteBool("Q0.5",False)
        siemens.WriteBool("Q0.6",False)
        siemens.WriteBool("Q1.2",False)
        siemens.WriteBool("Q1.3",False)
        siemens.WriteBool("Q1.5",False)
        siemens.WriteBool("Q1.6",False)
        time.sleep(0.1)
        #闪紫
        siemens.WriteBool("Q0.2",True)
        siemens.WriteBool("Q0.4",True)
        siemens.WriteBool("Q0.5",True)
        siemens.WriteBool("Q0.7",True)
        siemens.WriteBool("Q1.2",True)
        siemens.WriteBool("Q1.4",True)
        siemens.WriteBool("Q1.5",True)
        siemens.WriteBool("Q1.7",True)
        time.sleep(0.1)
        siemens.WriteBool("Q0.2",False)
        siemens.WriteBool("Q0.4",False)
        siemens.WriteBool("Q0.5",False)
        siemens.WriteBool("Q0.7",False)
        siemens.WriteBool("Q1.2",False)
        siemens.WriteBool("Q1.4",False)
        siemens.WriteBool("Q1.5",False)
        siemens.WriteBool("Q1.7",False)
        time.sleep(0.1)
        #闪青
        siemens.WriteBool("Q0.3",True)
        siemens.WriteBool("Q0.4",True)
        siemens.WriteBool("Q0.6",True)
        siemens.WriteBool("Q0.7",True)
        siemens.WriteBool("Q1.3",True)
        siemens.WriteBool("Q1.4",True)
        siemens.WriteBool("Q1.6",True)
        siemens.WriteBool("Q1.7",True)
        time.sleep(0.1)
        siemens.WriteBool("Q0.3",False)
        siemens.WriteBool("Q0.4",False)
        siemens.WriteBool("Q0.6",False)
        siemens.WriteBool("Q0.7",False)
        siemens.WriteBool("Q1.3",False)
        siemens.WriteBool("Q1.4",False)
        siemens.WriteBool("Q1.6",False)
        siemens.WriteBool("Q1.7",False)
        time.sleep(0.1)
        #闪白
        siemens.WriteBool("Q0.2",True)
        siemens.WriteBool("Q0.3",True)
        siemens.WriteBool("Q0.4",True)
        siemens.WriteBool("Q0.5",True)
        siemens.WriteBool("Q0.6",True)
        siemens.WriteBool("Q0.7",True)
        siemens.WriteBool("Q1.2",True)
        siemens.WriteBool("Q1.3",True)
        siemens.WriteBool("Q1.4",True)
        siemens.WriteBool("Q1.5",True)
        siemens.WriteBool("Q1.6",True)
        siemens.WriteBool("Q1.7",True)
        time.sleep(0.1)
        siemens.WriteBool("Q0.2",False)
        siemens.WriteBool("Q0.3",False)
        siemens.WriteBool("Q0.4",False)
        siemens.WriteBool("Q0.5",False)
        siemens.WriteBool("Q0.6",False)
        siemens.WriteBool("Q0.7",False)
        siemens.WriteBool("Q1.2",False)
        siemens.WriteBool("Q1.3",False)
        siemens.WriteBool("Q1.4",False)
        siemens.WriteBool("Q1.5",False)
        siemens.WriteBool("Q1.6",False)
        siemens.WriteBool("Q1.7",False)
        a+=1
